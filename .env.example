# =============================================================================
# DICOM Web Viewer Stack - Environment Configuration
# =============================================================================
# Copy this file to .env and update all CHANGE_ME values before deployment
# =============================================================================

# -----------------------------------------------------------------------------
# Domain & Network
# -----------------------------------------------------------------------------
DOMAIN=imaging.denscan.kz
EXTERNAL_IP=91.201.42.100

# -----------------------------------------------------------------------------
# PostgreSQL (shared by Orthanc and Keycloak)
# -----------------------------------------------------------------------------
POSTGRES_USER=dicom
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_32_CHARS
POSTGRES_DB=orthanc

# Additional database for Keycloak
KC_DB_NAME=keycloak

# -----------------------------------------------------------------------------
# Keycloak Identity Provider
# -----------------------------------------------------------------------------
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=CHANGE_ME_ADMIN_PASSWORD_32_CHARS

# Database connection for Keycloak
KC_DB=postgres
KC_DB_URL=jdbc:postgresql://postgres:5432/keycloak
KC_DB_USERNAME=dicom
KC_DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD_32_CHARS

# Keycloak hostname settings
KC_HOSTNAME_STRICT=false
KC_PROXY=edge

# -----------------------------------------------------------------------------
# Orthanc DICOM Server
# -----------------------------------------------------------------------------
ORTHANC_USERNAME=orthanc
ORTHANC_PASSWORD=CHANGE_ME_ORTHANC_PASSWORD

# Orthanc PostgreSQL connection (same credentials as main postgres)
ORTHANC_POSTGRES_HOST=postgres
ORTHANC_POSTGRES_PORT=5432
ORTHANC_POSTGRES_DB=orthanc
ORTHANC_POSTGRES_USER=dicom
ORTHANC_POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_32_CHARS

# -----------------------------------------------------------------------------
# Storage Paths
# -----------------------------------------------------------------------------
DICOM_STORAGE_PATH=/data/dicom
INBOX_PATH=/data/inbox
PROCESSED_PATH=/data/processed
FAILED_PATH=/data/failed
BACKUP_PATH=/backup

# -----------------------------------------------------------------------------
# Data Retention
# -----------------------------------------------------------------------------
RETENTION_DAYS=365

# -----------------------------------------------------------------------------
# Timezone
# -----------------------------------------------------------------------------
TZ=Asia/Almaty

# -----------------------------------------------------------------------------
# Monitoring - Grafana
# -----------------------------------------------------------------------------
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_GRAFANA_PASSWORD

# -----------------------------------------------------------------------------
# Alerts (Optional - Telegram notifications)
# -----------------------------------------------------------------------------
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# Alertmanager webhook (optional)
ALERTMANAGER_WEBHOOK_URL=

# -----------------------------------------------------------------------------
# SSL/TLS Configuration
# -----------------------------------------------------------------------------
# Set to 'production' for Let's Encrypt, 'development' for self-signed
SSL_MODE=development

# Let's Encrypt email (required for production SSL)
LETSENCRYPT_EMAIL=admin@denscan.kz

# -----------------------------------------------------------------------------
# Resource Limits (adjust based on server capacity)
# -----------------------------------------------------------------------------
# Memory limits
POSTGRES_MEMORY_LIMIT=2g
KEYCLOAK_MEMORY_LIMIT=1g
ORTHANC_MEMORY_LIMIT=2g
OHIF_MEMORY_LIMIT=512m
NGINX_MEMORY_LIMIT=256m
IMPORTER_MEMORY_LIMIT=512m
PROMETHEUS_MEMORY_LIMIT=512m
GRAFANA_MEMORY_LIMIT=512m
LOKI_MEMORY_LIMIT=512m

# CPU limits
POSTGRES_CPU_LIMIT=2
KEYCLOAK_CPU_LIMIT=1
ORTHANC_CPU_LIMIT=2
OHIF_CPU_LIMIT=0.5
NGINX_CPU_LIMIT=1
IMPORTER_CPU_LIMIT=0.5

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_FORMAT=json

# -----------------------------------------------------------------------------
# Importer Service Configuration
# -----------------------------------------------------------------------------
# Seconds to wait for file stability before processing
IMPORTER_COOLDOWN_SECONDS=60

# Maximum concurrent uploads
IMPORTER_MAX_CONCURRENT=3

# Retry settings
IMPORTER_MAX_RETRIES=3
IMPORTER_RETRY_DELAY=10
